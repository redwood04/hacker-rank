SELECT 
    c.algorithm,
    ROUND(SUM(CASE WHEN QUARTER(t.dt) = 1 THEN t.volume ELSE 0 END), 6) AS Q1,
    ROUND(SUM(CASE WHEN QUARTER(t.dt) = 2 THEN t.volume ELSE 0 END), 6) AS Q2,
    ROUND(SUM(CASE WHEN QUARTER(t.dt) = 3 THEN t.volume ELSE 0 END), 6) AS Q3,
    ROUND(SUM(CASE WHEN QUARTER(t.dt) = 4 THEN t.volume ELSE 0 END), 6) AS Q4
FROM coins c
JOIN transactions t 
    ON c.code = t.coin_code
WHERE YEAR(t.dt) = 2020
GROUP BY c.algorithm
ORDER BY c.algorithm;
